{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$defs": {
    "const": {
      "type": "object",
      "properties": {
        "const": {},
        "type": {
          "type": "string"
        }
      },
      "required": [
        "const"
      ]
    },
    "varScope": {
      "type": "object",
      "properties": {
        "varScope": {
          "type": "object",
          "properties": {
            "name": {
              "type": "string"
            },
            "expr": {
              "$ref": "#/$defs/expr"
            },
            "body": {
              "$ref": "#/$defs/expr"
            }
          },
          "required": [
            "name",
            "expr",
            "body"
          ]
        }
      },
      "required": [
        "varScope"
      ]
    },
    "varRef": {
      "type": "object",
      "properties": {
        "varRef": {
          "type": "string"
        }
      },
      "required": [
        "varRef"
      ]
    },
    "ref": {
      "type": "object",
      "properties": {
        "ref": {
          "type": "string"
        }
      },
      "required": [
        "ref"
      ]
    },
    "func": {
      "type": "object",
      "properties": {
        "func": {
          "type": "object",
          "properties": {
            "name": {
              "type": "string"
            },
            "args": {
              "type": [
                "array",
                "object"
              ],
              "items": {
                "$ref": "#/$defs/expr"
              },
              "additionalProperties": {
                "$ref": "#/$defs/expr"
              }
            }
          },
          "required": [
            "name",
            "args"
          ]
        }
      },
      "required": [
        "func"
      ]
    },
    "and": {
      "type": "object",
      "properties": {
        "and": {
          "type": "array",
          "minItems": 2,
          "items": {
            "$ref": "#/$defs/expr"
          }
        }
      },
      "required": [
        "and"
      ]
    },
    "or": {
      "type": "object",
      "properties": {
        "or": {
          "type": "array",
          "minItems": 2,
          "items": {
            "$ref": "#/$defs/expr"
          }
        }
      },
      "required": [
        "or"
      ]
    },
    "not": {
      "type": "object",
      "properties": {
        "not": {
          "$ref": "#/$defs/expr"
        }
      },
      "required": [
        "not"
      ]
    },
    "equal": {
      "type": "object",
      "properties": {
        "equal": {
          "type": "array",
          "minItems": 2,
          "maxItems": 2,
          "items": {
            "$ref": "#/$defs/expr"
          }
        }
      },
      "required": [
        "equal"
      ]
    },
    "greater": {
      "type": "object",
      "properties": {
        "greater": {
          "type": "array",
          "minItems": 2,
          "maxItems": 2,
          "items": {
            "$ref": "#/$defs/expr"
          }
        }
      },
      "required": [
        "greater"
      ]
    },
    "less": {
      "type": "object",
      "properties": {
        "less": {
          "type": "array",
          "minItems": 2,
          "maxItems": 2,
          "items": {
            "$ref": "#/$defs/expr"
          }
        }
      },
      "required": [
        "less"
      ]
    },
    "like": {
      "type": "object",
      "properties": {
        "like": {
          "type": "object",
          "properties": {
            "expr": {
              "$ref": "#/$defs/expr"
            },
            "pattern": {
              "type": "array",
              "minItems": 1,
              "items": {
                "oneOf": [
                  {
                    "type": "object",
                    "properties": {
                      "anyChars": {
                        "type": [
                          "integer",
                          "null"
                        ],
                        "minimum": 1
                      }
                    },
                    "required": [
                      "anyChars"
                    ]
                  },
                  {
                    "type": "string"
                  }
                ]
              }
            }
          },
          "required": [
            "expr",
            "pattern"
          ]
        }
      },
      "required": [
        "like"
      ]
    },
    "expr": {
      "oneOf": [
        {
          "$ref": "#/$defs/const"
        },
        {
          "$ref": "#/$defs/varScope"
        },
        {
          "$ref": "#/$defs/varRef"
        },
        {
          "$ref": "#/$defs/ref"
        },
        {
          "$ref": "#/$defs/func"
        },
        {
          "$ref": "#/$defs/and"
        },
        {
          "$ref": "#/$defs/or"
        },
        {
          "$ref": "#/$defs/not"
        },
        {
          "$ref": "#/$defs/equal"
        },
        {
          "$ref": "#/$defs/greater"
        },
        {
          "$ref": "#/$defs/less"
        },
        {
          "$ref": "#/$defs/like"
        }
      ]
    }
  },
  "$ref": "#/$defs/expr"
}